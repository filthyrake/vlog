# VLog Configuration
# Copy this file to .env and modify as needed.
# All values shown are the defaults.

# =============================================================================
# Storage Paths
# =============================================================================

# Base storage path for all video files
VLOG_STORAGE_PATH=/mnt/nas/vlog-storage

# Subdirectories within storage path
VLOG_VIDEOS_SUBDIR=videos
VLOG_UPLOADS_SUBDIR=uploads
VLOG_ARCHIVE_SUBDIR=archive

# SQLite database path (keep local for performance)
VLOG_DATABASE_PATH=./vlog.db

# =============================================================================
# Server Ports
# =============================================================================

# Public API port (video browsing, playback, analytics)
VLOG_PUBLIC_PORT=9000

# Admin API port (uploads, management - internal only)
VLOG_ADMIN_PORT=9001

# =============================================================================
# CLI Settings
# =============================================================================

# Admin API URL for CLI (overrides VLOG_ADMIN_PORT if set)
# VLOG_ADMIN_API_URL=http://localhost:9001

# Download timeout for yt-dlp in seconds
VLOG_DOWNLOAD_TIMEOUT=3600

# =============================================================================
# Soft Delete
# =============================================================================

# Days to keep archived videos before permanent deletion
VLOG_ARCHIVE_RETENTION_DAYS=30

# =============================================================================
# HLS Settings
# =============================================================================

# Segment duration in seconds
VLOG_HLS_SEGMENT_DURATION=6

# =============================================================================
# Transcoding Settings
# =============================================================================

# Checkpoint interval in seconds
VLOG_CHECKPOINT_INTERVAL=30

# Seconds before a job is considered stale (30 min default)
VLOG_JOB_STALE_TIMEOUT=1800

# Maximum retry attempts for failed jobs
VLOG_MAX_RETRY_ATTEMPTS=3

# Backoff base in seconds (doubles each retry)
VLOG_RETRY_BACKOFF_BASE=60

# Clean up partial files on failure
VLOG_CLEANUP_PARTIAL_ON_FAILURE=true

# Keep completed qualities on retry (don't re-transcode)
VLOG_KEEP_COMPLETED_QUALITIES=true

# =============================================================================
# FFmpeg Timeout Settings
# =============================================================================

# Timeout multiplier (timeout = video_duration * multiplier)
VLOG_FFMPEG_TIMEOUT_MULTIPLIER=3

# Minimum timeout in seconds (5 minutes)
VLOG_FFMPEG_TIMEOUT_MINIMUM=300

# Maximum timeout in seconds (1 hour)
VLOG_FFMPEG_TIMEOUT_MAXIMUM=3600

# =============================================================================
# Transcription Settings (Whisper)
# =============================================================================

# Whisper model: tiny, base, small, medium, large-v3
VLOG_WHISPER_MODEL=medium

# Enable/disable auto-transcription
VLOG_TRANSCRIPTION_ENABLED=true

# Language code for transcription (leave empty for auto-detect)
# VLOG_TRANSCRIPTION_LANGUAGE=en

# Auto-transcribe new uploads
VLOG_TRANSCRIPTION_ON_UPLOAD=true

# Compute type for faster-whisper: float16, int8, int8_float16
VLOG_TRANSCRIPTION_COMPUTE_TYPE=int8

# Transcription timeout in seconds (1 hour)
VLOG_TRANSCRIPTION_TIMEOUT=3600

# Audio extraction timeout in seconds (5 minutes)
VLOG_AUDIO_EXTRACTION_TIMEOUT=300

# =============================================================================
# Worker Settings
# =============================================================================

# Use inotify-based filesystem watcher instead of polling
VLOG_WORKER_USE_FILESYSTEM_WATCHER=true

# Fallback poll interval in seconds (safety net)
VLOG_WORKER_FALLBACK_POLL_INTERVAL=60

# Debounce delay in seconds after file event
VLOG_WORKER_DEBOUNCE_DELAY=1.0

# =============================================================================
# Testing
# =============================================================================

# Set to skip directory creation (for CI/tests)
# VLOG_TEST_MODE=1
