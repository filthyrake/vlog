# VLog Worker PodDisruptionBudget
# Ensures at least 1 CPU worker pod remains available during voluntary disruptions
# kubectl apply -f k8s/worker-pdb.yaml
#
# Prevents all worker pods from being evicted simultaneously during:
# - Node drains (kubectl drain)
# - Cluster autoscaling
# - Node upgrades/maintenance
# - Voluntary disruptions
#
# Note: PDB does not prevent involuntary disruptions (e.g., node failure, OOM kills)

apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: vlog-worker-pdb
  namespace: vlog
  labels:
    app.kubernetes.io/name: vlog
    app.kubernetes.io/component: worker
spec:
  # Ensure at least 1 worker pod remains available
  # Adjust based on your minimum capacity requirements
  minAvailable: 1
  
  selector:
    matchLabels:
      app.kubernetes.io/name: vlog
      app.kubernetes.io/component: worker
